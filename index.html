<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Code Repository</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0066cc 0%, #004499 50%, #ffffff 100%);
            min-height: 100vh;
            color: #333;
            padding: 0;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 2px solid #0066cc;
            padding: 25px 0;
            margin-bottom: 40px;
            box-shadow: 0 2px 10px rgba(0, 102, 204, 0.1);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .logo-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 30px;
        }

        .logo-container {
            width: 140px;
            height: 90px;
            border: 2px solid #0066cc;
            border-radius: 12px;
            overflow: hidden;
            background: white;
            box-shadow: 0 4px 12px rgba(0, 102, 204, 0.15);
            transition: transform 0.3s ease;
        }

        .logo-container:hover {
            transform: translateY(-3px);
        }

        .logo-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            padding: 8px;
        }

        .title-section {
            text-align: center;
        }

        .main-title {
            font-size: 3em;
            color: #0066cc;
            font-weight: 700;
            margin-bottom: 15px;
            text-shadow: 0 2px 4px rgba(0, 102, 204, 0.3);
        }

        .subtitle {
            font-size: 1.4em;
            color: #004499;
            font-weight: 400;
        }

        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 50px;
            box-shadow: 0 15px 40px rgba(0, 102, 204, 0.2);
            border: 1px solid rgba(0, 102, 204, 0.2);
        }

        /* Collapsible Tab Button */
        .tab-toggle-btn {
            background: linear-gradient(135deg, #004499, #0066cc);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 68, 153, 0.3);
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 10px;
            justify-content: center;
            width: 250px;
        }

        .tab-toggle-btn:hover {
            background: linear-gradient(135deg, #0066cc, #004499);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 102, 204, 0.4);
        }

        .tab-toggle-btn .arrow {
            font-size: 1.2em;
            transition: transform 0.3s ease;
        }

        .tab-toggle-btn.collapsed .arrow {
            transform: rotate(-90deg);
        }

        /* Tab Navigation */
        .tab-navigation {
            display: flex;
            flex-wrap: wrap;
            border-bottom: 3px solid #0066cc;
            margin-bottom: 40px;
            gap: 5px;
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            transition: all 0.5s ease;
        }

        .tab-navigation.expanded {
            max-height: 200px;
            opacity: 1;
            margin-bottom: 40px;
        }

        .tab-button {
            background: rgba(0, 102, 204, 0.1);
            border: none;
            padding: 15px 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            color: #004499;
            border-radius: 10px 10px 0 0;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            margin-bottom: -3px;
            position: relative;
        }

        .tab-button:hover {
            background: rgba(0, 102, 204, 0.2);
            color: #0066cc;
        }

        .tab-button.active {
            background: #0066cc;
            color: white;
            border-bottom: 3px solid #0066cc;
            transform: translateY(3px);
        }

        /* Tab Content */
        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease-in;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Content Sections */
        .section-header {
            color: #0066cc;
            font-size: 2.2em;
            font-weight: 700;
            margin-bottom: 30px;
            text-align: center;
            padding: 20px;
            background: rgba(0, 102, 204, 0.1);
            border-radius: 15px;
            border-left: 5px solid #0066cc;
        }

        /* Collapsible Sections */
        .collapsible-section {
            margin-bottom: 30px;
            border: 2px solid rgba(0, 102, 204, 0.2);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 102, 204, 0.1);
        }

        .section-toggle {
            background: linear-gradient(135deg, #0066cc, #004499);
            color: white;
            border: none;
            padding: 20px;
            width: 100%;
            text-align: left;
            cursor: pointer;
            font-size: 1.3em;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .section-toggle:hover {
            background: linear-gradient(135deg, #004499, #0066cc);
        }

        .section-toggle::after {
            content: 'â–¼';
            font-size: 1.2em;
            transition: transform 0.3s ease;
        }

        .section-toggle.collapsed::after {
            transform: rotate(-90deg);
        }

        .section-content {
            background: rgba(255, 255, 255, 0.95);
            max-height: 0;
            overflow: hidden;
            transition: all 0.5s ease;
            padding: 0;
        }

        .section-content.expanded {
            max-height: none;
            padding: 20px;
        }

        .content-text {
            font-size: 1.1em;
            line-height: 1.6;
            color: #333;
            margin-bottom: 25px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 10px;
            border-left: 4px solid #0066cc;
        }

        /* Markdown Display */
        .markdown-display {
            font-size: 1.1em;
            line-height: 1.6;
            color: #333;
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            border-left: 4px solid #0066cc;
            margin-top: 20px;
        }

        .markdown-display h1 {
            color: #0066cc;
            margin: 30px 0 20px 0;
            font-size: 2em;
            border-bottom: 2px solid #0066cc;
            padding-bottom: 10px;
        }

        .markdown-display h2 {
            color: #004499;
            margin: 25px 0 15px 0;
            font-size: 1.5em;
            border-bottom: 1px solid #004499;
            padding-bottom: 5px;
        }

        .markdown-display h3 {
            color: #0066cc;
            margin: 20px 0 10px 0;
            font-size: 1.3em;
        }

        .markdown-display pre {
            background: #1e293b;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            border-left: 4px solid #0066cc;
        }

        .markdown-display code {
            background: rgba(0,102,204,0.1);
            padding: 2px 6px;
            border-radius: 4px;
            color: #004499;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        }

        .markdown-display pre code {
            background: none;
            padding: 0;
            color: #e2e8f0;
        }

        .markdown-display strong {
            color: #004499;
            font-weight: 600;
        }

        .markdown-display em {
            color: #666;
            font-style: italic;
        }

        .markdown-display ul, .markdown-display ol {
            margin: 15px 0;
            padding-left: 30px;
        }

        .markdown-display li {
            margin: 5px 0;
            color: #333;
        }

        .markdown-display table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            border: 2px solid #0066cc;
        }

        .markdown-display td, .markdown-display th {
            padding: 12px;
            border: 1px solid #ddd;
            text-align: left;
        }

        .markdown-display th {
            background: rgba(0, 102, 204, 0.1);
            font-weight: 600;
            color: #004499;
            border-bottom: 2px solid #0066cc;
        }

        .markdown-display a {
            color: #0066cc;
            text-decoration: none;
            border-bottom: 1px solid transparent;
            transition: border-bottom 0.3s ease;
        }

        .markdown-display a:hover {
            border-bottom: 1px solid #0066cc;
        }

        .loading-state {
            text-align: center;
            padding: 60px 20px;
            color: #0066cc;
            background: rgba(0, 102, 204, 0.05);
            border-radius: 15px;
            border: 2px solid rgba(0, 102, 204, 0.2);
        }

        .loading-icon {
            font-size: 3em;
            margin-bottom: 20px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.5; }
            50% { opacity: 1; }
            100% { opacity: 0.5; }
        }

        .loading-title {
            font-size: 1.5em;
            font-weight: 600;
            margin-bottom: 10px;
            color: #004499;
        }

        .loading-text {
            font-size: 1.1em;
            opacity: 0.8;
        }

        .error-state {
            text-align: center;
            padding: 60px 20px;
            color: #ef4444;
            background: rgba(239, 68, 68, 0.05);
            border-radius: 15px;
            border: 2px solid rgba(239, 68, 68, 0.2);
        }

        .error-icon {
            font-size: 3em;
            margin-bottom: 20px;
        }

        .error-title {
            font-size: 1.5em;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .error-text {
            font-size: 1.1em;
            opacity: 0.8;
        }

        @media (max-width: 768px) {
            .main-title {
                font-size: 2.2em;
            }
            
            .subtitle {
                font-size: 1.2em;
            }
            
            .logo-section {
                justify-content: center;
            }
            
            .logo-container {
                width: 120px;
                height: 80px;
            }
            
            .dashboard-container {
                padding: 30px;
            }

            .tab-navigation {
                flex-direction: column;
            }

            .tab-button {
                border-radius: 10px;
                margin-bottom: 5px;
                padding: 12px 20px;
                font-size: 0.9em;
            }

            .tab-button.active {
                transform: none;
            }

            .tab-toggle-btn {
                width: 200px;
                padding: 12px 20px;
                font-size: 1em;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <!-- Logo Section for 4 logos -->
            <div class="logo-section">
                <div class="logo-container">
                    <img src="NMCP.png" alt="NMCP Logo" class="logo-image">
                </div>
                
                <div class="logo-container">
                    <img src="WHO.png" alt="WHO Logo" class="logo-image">
                </div>
                
                <div class="logo-container">
                    <img src="CHAI2.png" alt="CHAI Logo" class="logo-image">
                </div>

                <div class="logo-container">
                    <img src="ICF-SL.jpg" alt="ICF-SL Logo" class="logo-image">
                </div>
            </div>
            
            <!-- Title Section -->
            <div class="title-section">
                <h1 class="main-title">Code Repository</h1>
                <h2 class="subtitle">Code Repository and Analysis System</h2>
                <h3 class="subtitle">by</h3>
                <h2 class="subtitle">Informatics Consultancy Firm Sierra Leone (ICF-SL)</h2>
                <h2 class="subtitle"><em>A local firm with international standards</em></h2>
            </div>
        </div>
    </div>

    <div class="dashboard-container">
        <!-- Tab Toggle Button -->
        <button class="tab-toggle-btn collapsed" onclick="toggleTabs()" id="tabToggleBtn">
            <span>ðŸ“‚</span>
            <span>Show Navigation Menu</span>
            <span class="arrow">â–¼</span>
        </button>

        <!-- Tab Navigation -->
        <div class="tab-navigation" id="tabNavigation">
            <button class="tab-button active" onclick="openTab(event, 'overview')">Overview</button>
            <button class="tab-button" onclick="openTab(event, 'markdown-content')">Documentation</button>
            <button class="tab-button" onclick="openTab(event, 'data-visualization')">Data Visualization</button>
            <button class="tab-button" onclick="openTab(event, 'reports-export')">Reports & Export</button>
        </div>

        <!-- Tab Contents -->
        <div id="overview" class="tab-content active">
            <div class="section-header">Code Repository</div>
            
            <!-- Code Repository Introduction -->
            <div class="collapsible-section">
                <button class="section-toggle" onclick="toggleSection(this)">
                    ðŸ’» Code Repository Overview
                </button>
                <div class="section-content expanded">
                    <div class="content-text">
                        <strong>Malaria Data Analysis Code Repository</strong><br>
                        This system provides a comprehensive collection of Python scripts and analysis tools designed specifically for the National Malaria Control Programme (NMCP) in Sierra Leone. 
                        The code repository contains standardized functions for processing malaria surveillance data, calculating key indicators, and generating analytical reports that support evidence-based decision making.
                        <br><br>
                        <strong>Features:</strong>
                        <ul style="margin-top: 10px; padding-left: 20px;">
                            <li>Automatic markdown file reading from <code>content.md</code></li>
                            <li>Syntax-highlighted code display</li>
                            <li>Professional documentation formatting</li>
                            <li>Responsive design for all devices</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Documentation Tab -->
        <div id="markdown-content" class="tab-content">
            <div class="section-header">Documentation</div>
            <div id="markdownDisplay">
                <div class="loading-state">
                    <div class="loading-icon">ðŸ“„</div>
                    <div class="loading-title">Loading Documentation...</div>
                    <div class="loading-text">Reading content from content.md file</div>
                </div>
            </div>
        </div>

        <!-- Data Visualization Tab -->
        <div id="data-visualization" class="tab-content">
            <div class="section-header">Data Visualization</div>
            <div class="content-text">
                <strong>Visualization Tools</strong><br>
                This section contains tools and charts for visualizing malaria surveillance data. Content will be populated from the markdown documentation.
            </div>
        </div>

        <!-- Reports & Export Tab -->
        <div id="reports-export" class="tab-content">
            <div class="section-header">Reports & Export</div>
            <div class="content-text">
                <strong>Report Generation</strong><br>
                This section contains tools for generating reports and exporting analysis results. Content will be populated from the markdown documentation.
            </div>
        </div>
    </div>

    <script>
        function openTab(evt, tabName) {
            // Hide all tab contents
            var tabcontents = document.getElementsByClassName("tab-content");
            for (var i = 0; i < tabcontents.length; i++) {
                tabcontents[i].classList.remove("active");
            }
            
            // Remove active class from all tab buttons
            var tabbuttons = document.getElementsByClassName("tab-button");
            for (var i = 0; i < tabbuttons.length; i++) {
                tabbuttons[i].classList.remove("active");
            }
            
            // Show the selected tab content and mark button as active
            var targetTab = document.getElementById(tabName);
            if (targetTab) {
                targetTab.classList.add("active");
            }
            if (evt && evt.currentTarget) {
                evt.currentTarget.classList.add("active");
            }
            
            // Auto-collapse navigation after tab selection
            var tabNav = document.getElementById("tabNavigation");
            var toggleBtn = document.getElementById("tabToggleBtn");
            if (tabNav && toggleBtn) {
                tabNav.classList.remove("expanded");
                toggleBtn.classList.add("collapsed");
                toggleBtn.innerHTML = '<span>ðŸ“‚</span><span>Show Navigation Menu</span><span class="arrow">â–¼</span>';
            }
        }

        function toggleTabs() {
            var tabNav = document.getElementById("tabNavigation");
            var toggleBtn = document.getElementById("tabToggleBtn");
            
            if (tabNav && toggleBtn) {
                if (tabNav.classList.contains("expanded")) {
                    // Collapse the menu
                    tabNav.classList.remove("expanded");
                    toggleBtn.classList.add("collapsed");
                    toggleBtn.innerHTML = '<span>ðŸ“‚</span><span>Show Navigation Menu</span><span class="arrow">â–¼</span>';
                } else {
                    // Expand the menu
                    tabNav.classList.add("expanded");
                    toggleBtn.classList.remove("collapsed");
                    toggleBtn.innerHTML = '<span>ðŸ“‚</span><span>Hide Navigation Menu</span><span class="arrow">â–¼</span>';
                }
            }
        }

        function toggleSection(button) {
            if (!button || !button.nextElementSibling) return;
            
            var content = button.nextElementSibling;
            var isCollapsed = content.classList.contains("expanded");
            
            if (isCollapsed) {
                content.classList.remove("expanded");
                button.classList.add("collapsed");
            } else {
                content.classList.add("expanded");
                button.classList.remove("collapsed");
            }
        }

        async function loadMarkdownFile() {
            const display = document.getElementById('markdownDisplay');
            
            try {
                // Try to load content.md from the same directory
                const response = await fetch('content.md');
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const markdownContent = await response.text();
                renderMarkdownDisplay(markdownContent);
                
            } catch (error) {
                console.log('Could not load content.md:', error.message);
                
                // Show error state with helpful message and color reference
                display.innerHTML = `
                    <div class="error-state">
                        <div class="error-icon">ðŸ“„</div>
                        <div class="error-title">Documentation File Not Found</div>
                        <div class="error-text">
                            Please place a <strong>content.md</strong> file in the same directory as this HTML file.<br>
                            The system will automatically read and display its contents here.
                        </div>
                        <div style="margin-top: 30px; padding: 20px; background: rgba(0,102,204,0.1); border-radius: 10px; text-align: left;">
                            <h3 style="color: var(--primary-blue); margin-bottom: 15px;">ðŸŽ¨ Syntax Highlighting Test:</h3>
                            <div style="background: var(--code-bg); padding: 15px; border-radius: 8px; margin: 10px 0;">
                                <pre style="margin: 0; color: var(--code-text); font-family: monospace;"><code><span class="comment"># Sample Python code with syntax highlighting</span>
<span class="keyword">import</span> <span class="function">pandas</span> <span class="keyword">as</span> <span class="variable">pd</span>
<span class="keyword">import</span> <span class="function">numpy</span> <span class="keyword">as</span> <span class="variable">np</span>

<span class="keyword">def</span> <span class="function">analyze_data</span>(<span class="variable">filename</span>):
    <span class="string">"""Load and analyze malaria data"""</span>
    <span class="variable">df</span> <span class="operator">=</span> <span class="variable">pd</span><span class="operator">.</span><span class="function">read_csv</span>(<span class="variable">filename</span>)
    <span class="variable">result</span> <span class="operator">=</span> <span class="variable">df</span><span class="operator">.</span><span class="function">mean</span>()
    <span class="builtin">print</span>(<span class="string">f"Average: </span><span class="operator">{</span><span class="variable">result</span><span class="operator">}</span><span class="string">"</span>)
    <span class="keyword">return</span> <span class="variable">result</span></code></pre>
                            </div>
                            <div style="font-family: monospace; line-height: 1.8;">
                                <strong>Color Reference:</strong><br>
                                <span class="keyword">Keywords:</span> <code style="color: var(--keyword-purple);">#7c3aed</code> (import, def, return)<br>
                                <span class="function">Functions:</span> <code style="color: var(--function-blue);">#3b82f6</code> (pandas, numpy)<br>
                                <span class="string">Strings:</span> <code style="color: var(--string-green);">#10b981</code> ("text")<br>
                                <span class="comment">Comments:</span> <code style="color: var(--comment-gray);">#64748b</code> (# comments)<br>
                                <span class="variable">Variables:</span> <code style="color: var(--variable-orange);">#f59e0b</code> (df, data)<br>
                                <span class="number">Numbers:</span> <code style="color: var(--number-red);">#ef4444</code> (123, 45.6)<br>
                                <span class="operator">Operators:</span> <code style="color: var(--operator-purple);">#8b5cf6</code> (=, +, -)<br>
                                <span class="builtin">Built-ins:</span> <code style="color: #06b6d4;">#06b6d4</code> (print, len)<br>
                            </div>
                        </div>
                    </div>
                `;
            }
        }

        function renderMarkdownDisplay(markdownText) {
            const display = document.getElementById('markdownDisplay');
            if (!display) return;
            
            // Enhanced markdown to HTML conversion with syntax highlighting
            let html = markdownText
                // Headers
                .replace(/^### (.*$)/gim, '<h3>$1</h3>')
                .replace(/^## (.*$)/gim, '<h2>$1</h2>')
                .replace(/^# (.*$)/gim, '<h1>$1</h1>')
                
                // Code blocks with syntax highlighting
                .replace(/```(python|py)?\n([\s\S]*?)\n```/g, function(match, language, code) {
                    const highlightedCode = applySyntaxHighlighting(code.trim());
                    return `<pre><code>${highlightedCode}</code></pre>`;
                })
                
                // Generic code blocks (without language specified)
                .replace(/```\n([\s\S]*?)\n```/g, function(match, code) {
                    // Try to detect if it's Python code
                    if (code.includes('import ') || code.includes('def ') || code.includes('print(') || code.includes('pd.') || code.includes('np.')) {
                        const highlightedCode = applySyntaxHighlighting(code.trim());
                        return `<pre><code>${highlightedCode}</code></pre>`;
                    } else {
                        return `<pre><code>${code.trim()}</code></pre>`;
                    }
                })
                
                // Inline code (don't highlight, just style)
                .replace(/`([^`]+)`/g, '<code>$1</code>')
                
                // Bold
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                // Italic
                .replace(/\*(.*?)\*/g, '<em>$1</em>')
                // Links
                .replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2" target="_blank">$1</a>')
                // Unordered lists
                .replace(/^\* (.+$)/gm, '<li>$1</li>')
                .replace(/^\- (.+$)/gm, '<li>$1</li>')
                // Ordered lists
                .replace(/^\d+\. (.+$)/gm, '<li>$1</li>')
                // Tables
                .replace(/\|(.+)\|\n/g, function(match, content) {
                    const cells = content.split('|').map(cell => cell.trim()).filter(cell => cell);
                    return '<tr>' + cells.map(cell => {
                        // Check if it's a header row (contains dashes)
                        if (cell.includes('---')) {
                            return '';
                        }
                        return `<td>${cell}</td>`;
                    }).join('') + '</tr>';
                })
                // Line breaks and paragraphs
                .replace(/\n\n/g, '</p><p>')
                .replace(/\n/g, '<br>');
            
            // Wrap lists properly
            html = html.replace(/(<li>.*?<\/li>)/gs, function(match) {
                return '<ul>' + match + '</ul>';
            });
            
            // Wrap tables
            html = html.replace(/(<tr>.*?<\/tr>)/gs, function(match) {
                return '<table>' + match + '</table>';
            });
            
            // Clean up empty elements
            html = html.replace(/<tr><\/tr>/g, '');
            html = html.replace(/<ul><\/ul>/g, '');
            html = html.replace(/<p><\/p>/g, '');
            
            // Final wrapping
            html = '<div class="markdown-display"><p>' + html + '</p></div>';
            
            display.innerHTML = html;
            
            // Show success message
            console.log('âœ… Markdown loaded and syntax highlighting applied!');
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            // Set navigation as collapsed by default
            var tabNav = document.getElementById("tabNavigation");
            var toggleBtn = document.getElementById("tabToggleBtn");
            
            if (tabNav && toggleBtn) {
                tabNav.classList.remove("expanded");
                toggleBtn.classList.add("collapsed");
            }
            
            // Load the markdown file automatically
            loadMarkdownFile();
        });
    </script>
</body>
</html>
