<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Malaria Program Review (MPR) - Code Repository</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0066cc 0%, #004499 50%, #ffffff 100%);
            min-height: 100vh;
            color: #333;
            padding: 0;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 2px solid #0066cc;
            padding: 25px 0;
            margin-bottom: 40px;
            box-shadow: 0 2px 10px rgba(0, 102, 204, 0.1);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .logo-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 30px;
        }

        .logo-container {
            width: 140px;
            height: 90px;
            border: 2px solid #0066cc;
            border-radius: 12px;
            overflow: hidden;
            background: white;
            box-shadow: 0 4px 12px rgba(0, 102, 204, 0.15);
            transition: transform 0.3s ease;
        }

        .logo-container:hover {
            transform: translateY(-3px);
        }

        .logo-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            padding: 8px;
        }

        .title-section {
            text-align: center;
        }

        .main-title {
            font-size: 3em;
            color: #0066cc;
            font-weight: 700;
            margin-bottom: 15px;
            text-shadow: 0 2px 4px rgba(0, 102, 204, 0.3);
        }

        .subtitle {
            font-size: 1.4em;
            color: #004499;
            font-weight: 400;
        }

        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 50px;
            box-shadow: 0 15px 40px rgba(0, 102, 204, 0.2);
            border: 1px solid rgba(0, 102, 204, 0.2);
        }

        /* Collapsible Tab Button */
        .tab-toggle-btn {
            background: linear-gradient(135deg, #004499, #0066cc);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 68, 153, 0.3);
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 10px;
            justify-content: center;
            width: 250px;
        }

        .tab-toggle-btn:hover {
            background: linear-gradient(135deg, #0066cc, #004499);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 102, 204, 0.4);
        }

        .tab-toggle-btn .arrow {
            font-size: 1.2em;
            transition: transform 0.3s ease;
        }

        .tab-toggle-btn.collapsed .arrow {
            transform: rotate(-90deg);
        }

        /* Tab Navigation */
        .tab-navigation {
            display: flex;
            flex-wrap: wrap;
            border-bottom: 3px solid #0066cc;
            margin-bottom: 40px;
            gap: 5px;
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            transition: all 0.5s ease;
        }

        .tab-navigation.expanded {
            max-height: 200px;
            opacity: 1;
            margin-bottom: 40px;
        }

        .tab-button {
            background: rgba(0, 102, 204, 0.1);
            border: none;
            padding: 15px 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            color: #004499;
            border-radius: 10px 10px 0 0;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            margin-bottom: -3px;
            position: relative;
        }

        .tab-button:hover {
            background: rgba(0, 102, 204, 0.2);
            color: #0066cc;
        }

        .tab-button.active {
            background: #0066cc;
            color: white;
            border-bottom: 3px solid #0066cc;
            transform: translateY(3px);
        }

        /* Tab Content */
        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease-in;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Content Sections */
        .section-header {
            color: #0066cc;
            font-size: 2.2em;
            font-weight: 700;
            margin-bottom: 30px;
            text-align: center;
            padding: 20px;
            background: rgba(0, 102, 204, 0.1);
            border-radius: 15px;
            border-left: 5px solid #0066cc;
        }

        /* Collapsible Sections */
        .collapsible-section {
            margin-bottom: 30px;
            border: 2px solid rgba(0, 102, 204, 0.2);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 102, 204, 0.1);
        }

        .section-toggle {
            background: linear-gradient(135deg, #0066cc, #004499);
            color: white;
            border: none;
            padding: 20px;
            width: 100%;
            text-align: left;
            cursor: pointer;
            font-size: 1.3em;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .section-toggle:hover {
            background: linear-gradient(135deg, #004499, #0066cc);
        }

        .section-toggle::after {
            content: '▼';
            font-size: 1.2em;
            transition: transform 0.3s ease;
        }

        .section-toggle.collapsed::after {
            transform: rotate(-90deg);
        }

        .section-content {
            background: rgba(255, 255, 255, 0.95);
            max-height: 0;
            overflow: hidden;
            transition: all 0.5s ease;
            padding: 0;
        }

        .section-content.expanded {
            max-height: none;
            padding: 20px;
        }

        .content-text {
            font-size: 1.1em;
            line-height: 1.6;
            color: #333;
            margin-bottom: 25px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 10px;
            border-left: 4px solid #0066cc;
        }

        /* Code Section Styling */
        .code-section {
            margin: 30px 0;
            border: 2px solid rgba(59, 130, 246, 0.3);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.1);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }

        .code-header {
            background: linear-gradient(135deg, #3b82f6, #1e40af);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .code-title {
            font-weight: 600;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .copy-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .copy-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .copy-btn.copied {
            background: #10b981;
            border-color: #10b981;
        }

        .code-container {
            background: #1e293b;
            padding: 0;
            position: relative;
            overflow-x: auto;
        }

        .code-content {
            padding: 25px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
            line-height: 1.6;
            color: #e2e8f0;
            white-space: pre;
            overflow-x: auto;
        }

        /* Syntax highlighting */
        .keyword {
            color: #7c3aed;
            font-weight: 600;
        }

        .function {
            color: #3b82f6;
            font-weight: 600;
        }

        .string {
            color: #10b981;
        }

        .comment {
            color: #64748b;
            font-style: italic;
        }

        .variable {
            color: #f59e0b;
        }

        .number {
            color: #ef4444;
        }

        .operator {
            color: #8b5cf6;
        }

        /* Output Section Styling */
        .output-section {
            margin: 30px 0;
            border: 2px solid rgba(16, 185, 129, 0.3);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.1);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }

        .output-header {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 15px 20px;
            font-weight: 600;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .output-container {
            background: #f8fafc;
            padding: 25px;
            border-top: 1px solid rgba(16, 185, 129, 0.1);
        }

        .output-content {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 13px;
            line-height: 1.5;
            color: #374151;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            overflow-x: auto;
            white-space: pre;
        }

        /* Step Description */
        .step-description {
            background: rgba(0, 102, 204, 0.05);
            border-left: 4px solid #0066cc;
            padding: 15px 20px;
            margin-bottom: 20px;
            border-radius: 0 10px 10px 0;
            color: #004499;
            font-size: 1em;
            line-height: 1.5;
            font-weight: 500;
        }

        /* Result Image Section */
        .result-image-section {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .result-image-frame {
            width: 100%;
            max-width: 1000px;
            min-height: 500px;
            border: 3px solid #10b981;
            border-radius: 20px;
            overflow: hidden;
            background: linear-gradient(145deg, #ffffff, #f0fff4);
            box-shadow: 
                0 20px 40px rgba(16, 185, 129, 0.15),
                inset 0 2px 4px rgba(255, 255, 255, 0.9),
                inset 0 -2px 4px rgba(16, 185, 129, 0.1);
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .result-image-frame:hover {
            transform: translateY(-5px);
            box-shadow: 
                0 25px 50px rgba(16, 185, 129, 0.2),
                inset 0 2px 4px rgba(255, 255, 255, 0.9),
                inset 0 -2px 4px rgba(16, 185, 129, 0.1);
        }

        .result-image-placeholder {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 500px;
            text-align: center;
            padding: 40px;
            color: #10b981;
            border: 2px dashed #10b981;
            border-radius: 15px;
            margin: 10px;
            background: rgba(255, 255, 255, 0.5);
            transition: all 0.3s ease;
        }

        .result-image-placeholder:hover {
            background: rgba(16, 185, 129, 0.05);
            border-color: #059669;
        }

        .uploaded-result-image {
            width: 100%;
            height: auto;
            max-height: 90vh;
            display: block;
            object-fit: contain;
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.2);
        }

        .image-upload-section {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .image-frame {
            width: 100%;
            max-width: 800px;
            min-height: 400px;
            border: 3px solid #0066cc;
            border-radius: 20px;
            overflow: hidden;
            background: linear-gradient(145deg, #ffffff, #f0f8ff);
            box-shadow: 
                0 20px 40px rgba(0, 102, 204, 0.15),
                inset 0 2px 4px rgba(255, 255, 255, 0.9),
                inset 0 -2px 4px rgba(0, 102, 204, 0.1);
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .image-frame:hover {
            transform: translateY(-5px);
            box-shadow: 
                0 25px 50px rgba(0, 102, 204, 0.2),
                inset 0 2px 4px rgba(255, 255, 255, 0.9),
                inset 0 -2px 4px rgba(0, 102, 204, 0.1);
        }

        .image-placeholder {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 400px;
            text-align: center;
            padding: 40px;
            color: #0066cc;
            border: 2px dashed #0066cc;
            border-radius: 15px;
            margin: 10px;
            background: rgba(255, 255, 255, 0.5);
            transition: all 0.3s ease;
        }

        .image-placeholder:hover {
            background: rgba(0, 102, 204, 0.05);
            border-color: #004499;
        }

        .placeholder-icon {
            font-size: 4em;
            margin-bottom: 20px;
            opacity: 0.7;
        }

        .placeholder-text {
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .placeholder-subtext {
            font-size: 1em;
            opacity: 0.7;
            font-style: italic;
        }

        /* Quick Access Buttons */
        .quick-access-btn {
            background: rgba(0, 102, 204, 0.1);
            color: #004499;
            border: 1px solid #0066cc;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .quick-access-btn:hover {
            background: #0066cc;
            color: white;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 102, 204, 0.3);
        }

        /* Loading Animation */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Markdown Content Styling */
        .markdown-content {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 30px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.7;
            color: #374151;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            max-height: 70vh;
            overflow-y: auto;
        }

        .markdown-content h1 {
            color: #0066cc;
            font-size: 2.2em;
            font-weight: 700;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #0066cc;
        }

        .markdown-content h2 {
            color: #004499;
            font-size: 1.8em;
            font-weight: 600;
            margin: 30px 0 15px 0;
            padding-left: 15px;
            border-left: 4px solid #0066cc;
        }

        .markdown-content h3 {
            color: #0066cc;
            font-size: 1.4em;
            font-weight: 600;
            margin: 25px 0 12px 0;
        }

        .markdown-content h4, .markdown-content h5, .markdown-content h6 {
            color: #004499;
            font-weight: 600;
            margin: 20px 0 10px 0;
        }

        .markdown-content p {
            margin-bottom: 16px;
            text-align: justify;
        }

        .markdown-content ul, .markdown-content ol {
            margin: 15px 0;
            padding-left: 30px;
        }

        .markdown-content li {
            margin-bottom: 8px;
            line-height: 1.6;
        }

        .markdown-content blockquote {
            background: rgba(0, 102, 204, 0.05);
            border-left: 4px solid #0066cc;
            margin: 20px 0;
            padding: 15px 20px;
            border-radius: 0 8px 8px 0;
            font-style: italic;
            color: #004499;
        }

        .markdown-content code {
            background: rgba(59, 130, 246, 0.1);
            color: #1e40af;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.9em;
        }

        .markdown-content pre {
            background: #1e293b;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
            border: 1px solid rgba(59, 130, 246, 0.3);
        }

        .markdown-content pre code {
            background: none;
            color: inherit;
            padding: 0;
            border-radius: 0;
        }

        .markdown-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            overflow: hidden;
        }

        .markdown-content th {
            background: #0066cc;
            color: white;
            padding: 12px 15px;
            text-align: left;
            font-weight: 600;
        }

        .markdown-content td {
            padding: 12px 15px;
            border-bottom: 1px solid #e2e8f0;
        }

        .markdown-content tr:nth-child(even) {
            background: rgba(0, 102, 204, 0.02);
        }

        .markdown-content img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 15px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .markdown-content a {
            color: #0066cc;
            text-decoration: none;
            font-weight: 500;
            border-bottom: 1px solid transparent;
            transition: all 0.3s ease;
        }

        .markdown-content a:hover {
            color: #004499;
            border-bottom-color: #004499;
        }

        .markdown-content strong {
            color: #004499;
            font-weight: 700;
        }

        .markdown-content em {
            color: #0066cc;
            font-style: italic;
        }

        .uploaded-image {
            width: 100%;
            height: auto;
            display: block;
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0, 102, 204, 0.2);
        }

        @media (max-width: 768px) {
            .main-title {
                font-size: 2.2em;
            }
            
            .subtitle {
                font-size: 1.2em;
            }
            
            .logo-section {
                justify-content: center;
            }
            
            .logo-container {
                width: 120px;
                height: 80px;
            }
            
            .dashboard-container {
                padding: 30px;
            }

            .tab-navigation {
                flex-direction: column;
            }

            .tab-button {
                border-radius: 10px;
                margin-bottom: 5px;
                padding: 12px 20px;
                font-size: 0.9em;
            }

            .tab-button.active {
                transform: none;
            }

            .tab-toggle-btn {
                width: 200px;
                padding: 12px 20px;
                font-size: 1em;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <!-- Logo Section for 4 logos -->
            <div class="logo-section">
                <div class="logo-container">
                    <img src="NMCP.png" alt="NMCP Logo" class="logo-image">
                </div>
                
                <div class="logo-container">
                    <img src="WHO.png" alt="WHO Logo" class="logo-image">
                </div>
                
                <div class="logo-container">
                    <img src="CHAI2.png" alt="CHAI Logo" class="logo-image">
                </div>

                <div class="logo-container">
                    <img src="ICF-SL.png" alt="ICF-SL Logo" class="logo-image">
                </div>
            </div>
            
            <!-- Title Section -->
            <div class="title-section">
                <h1 class="main-title">Malaria Program Review (MPR)</h1>
                <h2 class="subtitle">Code Repository and Analysis System</h2>
                <h3 class="subtitle">by</h3>
                <h2 class="subtitle">Informatics Consultancy Firm Sierra Leone (ICF-SL)</h2>
                <h2 class="subtitle"><em>A local firm with international standards</em></h2>
            </div>
        </div>
    </div>

    <div class="dashboard-container">
        <!-- Tab Toggle Button -->
        <button class="tab-toggle-btn collapsed" onclick="toggleTabs()" id="tabToggleBtn">
            <span>📂</span>
            <span>Show Navigation Menu</span>
            <span class="arrow">▼</span>
        </button>

        <!-- Tab Navigation -->
        <div class="tab-navigation" id="tabNavigation">
            <button class="tab-button active" onclick="openTab(event, 'overview')">Overview</button>
            <button class="tab-button" onclick="openTab(event, 'tab2')">Malaria Analysis Code</button>
            <button class="tab-button" onclick="openTab(event, 'tab3')">Data Visualization</button>
            <button class="tab-button" onclick="openTab(event, 'tab4')">Reports & Export</button>
        </div>

        <!-- Tab Contents -->
        <div id="overview" class="tab-content active">
            <div class="section-header">Code Repository</div>
            
            <!-- Code Repository Introduction -->
            <div class="collapsible-section">
                <button class="section-toggle collapsed" onclick="toggleSection(this)">
                    💻 Code Repository Overview
                </button>
                <div class="section-content">
                    <div class="content-text">
                        <strong>Malaria Data Analysis Code Repository</strong><br>
                        This system provides a comprehensive collection of Python scripts and analysis tools designed specifically for the National Malaria Control Programme (NMCP) in Sierra Leone. 
                        The code repository contains standardized functions for processing malaria surveillance data, calculating key indicators, and generating analytical reports that support evidence-based decision making.
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab 2 -->
        <div id="tab2" class="tab-content">
            <div class="section-header">Malaria Data Analysis Code</div>
            
            <!-- Step 1: Import Libraries -->
            <div class="collapsible-section">
                <button class="section-toggle collapsed" onclick="toggleSection(this)">
                    📋 Step 1: Import Required Libraries
                </button>
                <div class="section-content">
                    <div class="step-description">
                        Import all necessary Python libraries for data processing, analysis, and visualization.
                    </div>
                    <div class="code-section">
                        <div class="code-header">
                            <div class="code-title">
                                <span>💻</span>
                                Step 1 - Library Imports
                            </div>
                            <button class="copy-btn" onclick="copyCode('step1Code')" id="copyBtn1">
                                <span>📋</span>
                                Copy Code
                            </button>
                        </div>
                        <div class="code-container">
                            <div class="code-content" id="step1Code"><span class="comment"># Import necessary libraries</span>
<span class="keyword">import</span> <span class="function">pandas</span> <span class="keyword">as</span> <span class="variable">pd</span>
<span class="keyword">import</span> <span class="function">numpy</span> <span class="keyword">as</span> <span class="variable">np</span>
<span class="keyword">import</span> <span class="function">matplotlib.pyplot</span> <span class="keyword">as</span> <span class="variable">plt</span>
<span class="keyword">import</span> <span class="function">seaborn</span> <span class="keyword">as</span> <span class="variable">sns</span>
<span class="keyword">from</span> <span class="function">datetime</span> <span class="keyword">import</span> <span class="function">datetime</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 2: Define Analysis Function -->
            <div class="collapsible-section">
                <button class="section-toggle collapsed" onclick="toggleSection(this)">
                    🔬 Step 2: Define Main Analysis Function
                </button>
                <div class="section-content">
                    <div class="step-description">
                        Create the main function that will process malaria confirmation data and calculate key statistics.
                    </div>
                    <div class="code-section">
                        <div class="code-header">
                            <div class="code-title">
                                <span>💻</span>
                                Step 2 - Function Definition
                            </div>
                            <button class="copy-btn" onclick="copyCode('step2Code')" id="copyBtn2">
                                <span>📋</span>
                                Copy Code
                            </button>
                        </div>
                        <div class="code-container">
                            <div class="code-content" id="step2Code"><span class="keyword">def</span> <span class="function">analyze_malaria_confirmation</span>(<span class="variable">data_file</span>):
    <span class="string">"""
    Analyze malaria confirmation rates across districts and time periods
    
    Parameters:
    data_file (str): Path to the malaria data CSV file
    
    Returns:
    dict: Analysis results including trends and statistics
    """</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 3: Data Loading and Processing -->
            <div class="collapsible-section">
                <button class="section-toggle collapsed" onclick="toggleSection(this)">
                    📊 Step 3: Load and Process Data
                </button>
                <div class="section-content">
                    <div class="step-description">
                        Load the CSV data file and perform initial data processing including date conversion and confirmation rate calculation.
                    </div>
                    <div class="code-section">
                        <div class="code-header">
                            <div class="code-title">
                                <span>💻</span>
                                Step 3 - Data Processing
                            </div>
                            <button class="copy-btn" onclick="copyCode('step3Code')" id="copyBtn3">
                                <span>📋</span>
                                Copy Code
                            </button>
                        </div>
                        <div class="code-container">
                            <div class="code-content" id="step3Code">    <span class="comment"># Load the dataset</span>
    <span class="variable">df</span> <span class="operator">=</span> <span class="function">pd.read_csv</span>(<span class="variable">data_file</span>)
    
    <span class="comment"># Convert date column to datetime</span>
    <span class="variable">df</span>[<span class="string">'date'</span>] <span class="operator">=</span> <span class="function">pd.to_datetime</span>(<span class="variable">df</span>[<span class="string">'date'</span>])
    
    <span class="comment"># Calculate confirmation rate</span>
    <span class="variable">df</span>[<span class="string">'confirmation_rate'</span>] <span class="operator">=</span> (<span class="variable">df</span>[<span class="string">'confirmed_cases'</span>] <span class="operator">/</span> <span class="variable">df</span>[<span class="string">'tested_cases'</span>]) <span class="operator">*</span> <span class="number">100</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 4: Statistical Analysis -->
            <div class="collapsible-section">
                <button class="section-toggle collapsed" onclick="toggleSection(this)">
                    📈 Step 4: Calculate District Statistics
                </button>
                <div class="section-content">
                    <div class="step-description">
                        Group data by district and calculate comprehensive statistics including mean, standard deviation, min, max values.
                    </div>
                    <div class="code-section">
                        <div class="code-header">
                            <div class="code-title">
                                <span>💻</span>
                                Step 4 - Statistical Analysis
                            </div>
                            <button class="copy-btn" onclick="copyCode('step4Code')" id="copyBtn4">
                                <span>📋</span>
                                Copy Code
                            </button>
                        </div>
                        <div class="code-container">
                            <div class="code-content" id="step4Code">    <span class="comment"># Group by district and calculate statistics</span>
    <span class="variable">district_stats</span> <span class="operator">=</span> <span class="variable">df</span>.<span class="function">groupby</span>(<span class="string">'district'</span>).<span class="function">agg</span>({
        <span class="string">'confirmation_rate'</span>: [<span class="string">'mean'</span>, <span class="string">'std'</span>, <span class="string">'min'</span>, <span class="string">'max'</span>],
        <span class="string">'confirmed_cases'</span>: <span class="string">'sum'</span>,
        <span class="string">'tested_cases'</span>: <span class="string">'sum'</span>
    })</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 5: Trend Analysis -->
            <div class="collapsible-section">
                <button class="section-toggle collapsed" onclick="toggleSection(this)">
                    📅 Step 5: Monthly Trend Analysis
                </button>
                <div class="section-content">
                    <div class="step-description">
                        Calculate monthly trends by grouping data by time periods and districts to identify patterns over time.
                    </div>
                    <div class="code-section">
                        <div class="code-header">
                            <div class="code-title">
                                <span>💻</span>
                                Step 5 - Trend Analysis
                            </div>
                            <button class="copy-btn" onclick="copyCode('step5Code')" id="copyBtn5">
                                <span>📋</span>
                                Copy Code
                            </button>
                        </div>
                        <div class="code-container">
                            <div class="code-content" id="step5Code">    <span class="comment"># Calculate trend analysis</span>
    <span class="variable">monthly_trends</span> <span class="operator">=</span> <span class="variable">df</span>.<span class="function">groupby</span>([<span class="function">pd.Grouper</span>(<span class="variable">key</span><span class="operator">=</span><span class="string">'date'</span>, <span class="variable">freq</span><span class="operator">=</span><span class="string">'M'</span>), <span class="string">'district'</span>])[<span class="string">'confirmation_rate'</span>].<span class="function">mean</span>().<span class="function">reset_index</span>()</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 6: Return Results -->
            <div class="collapsible-section">
                <button class="section-toggle collapsed" onclick="toggleSection(this)">
                    📤 Step 6: Return Analysis Results
                </button>
                <div class="section-content">
                    <div class="step-description">
                        Return all calculated results in a structured dictionary format for easy access and further processing.
                    </div>
                    <div class="code-section">
                        <div class="code-header">
                            <div class="code-title">
                                <span>💻</span>
                                Step 6 - Return Results & Usage
                            </div>
                            <button class="copy-btn" onclick="copyCode('step6Code')" id="copyBtn6">
                                <span>📋</span>
                                Copy Code
                            </button>
                        </div>
                        <div class="code-container">
                            <div class="code-content" id="step6Code">    <span class="keyword">return</span> {
        <span class="string">'district_statistics'</span>: <span class="variable">district_stats</span>,
        <span class="string">'monthly_trends'</span>: <span class="variable">monthly_trends</span>,
        <span class="string">'overall_rate'</span>: <span class="variable">df</span>[<span class="string">'confirmation_rate'</span>].<span class="function">mean</span>()
    }

<span class="comment"># Example usage</span>
<span class="variable">results</span> <span class="operator">=</span> <span class="function">analyze_malaria_confirmation</span>(<span class="string">'malaria_data_2024.csv'</span>)
<span class="function">print</span>(<span class="string">f"Overall confirmation rate: {results['overall_rate']:.2f}%"</span>)</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sample Output Results -->
            <div class="collapsible-section">
                <button class="section-toggle collapsed" onclick="toggleSection(this)">
                    📊 Sample Output Results
                </button>
                <div class="section-content">
                    <div class="step-description">
                        View the sample output generated by running the analysis code. Upload your results.png image to display your analysis results.
                    </div>
                    <div class="result-image-section">
                        <div class="result-image-frame">
                            <input type="file" id="resultImageUpload" accept="image/*" onchange="displayResultImage(event)" style="display: none;">
                            <div class="result-image-placeholder" id="resultImagePlaceholder" onclick="document.getElementById('resultImageUpload').click();">
                                <div class="placeholder-icon">📊</div>
                                <div class="placeholder-text">Click to upload results.png</div>
                                <div class="placeholder-subtext">Upload your analysis output image</div>
                            </div>
                            <img id="uploadedResultImage" class="uploaded-result-image" style="display: none;" onclick="document.getElementById('resultImageUpload').click();">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab 3 -->
        <div id="tab3" class="tab-content">
            <div class="section-header">Data Visualization</div>
            <div class="content-text">
                This tab will contain data visualization tools and charts for malaria analysis.
            </div>
        </div>

        <!-- Tab 4 -->
        <div id="tab4" class="tab-content">
            <div class="section-header">Reports & Export</div>
            <div class="content-text">
                This tab will contain report generation and data export functionality.
            </div>
        </div>
    </div>

    <script>
        function openTab(evt, tabName) {
            // Hide all tab contents
            var tabcontents = document.getElementsByClassName("tab-content");
            for (var i = 0; i < tabcontents.length; i++) {
                tabcontents[i].classList.remove("active");
            }
            
            // Remove active class from all tab buttons
            var tabbuttons = document.getElementsByClassName("tab-button");
            for (var i = 0; i < tabbuttons.length; i++) {
                tabbuttons[i].classList.remove("active");
            }
            
            // Show the selected tab content and mark button as active
            var targetTab = document.getElementById(tabName);
            if (targetTab) {
                targetTab.classList.add("active");
            }
            if (evt && evt.currentTarget) {
                evt.currentTarget.classList.add("active");
            }
            
            // Auto-collapse navigation after tab selection
            var tabNav = document.getElementById("tabNavigation");
            var toggleBtn = document.getElementById("tabToggleBtn");
            if (tabNav && toggleBtn) {
                tabNav.classList.remove("expanded");
                toggleBtn.classList.add("collapsed");
                toggleBtn.innerHTML = '<span>📂</span><span>Show Navigation Menu</span><span class="arrow">▼</span>';
            }
        }

        function toggleTabs() {
            var tabNav = document.getElementById("tabNavigation");
            var toggleBtn = document.getElementById("tabToggleBtn");
            
            if (tabNav && toggleBtn) {
                if (tabNav.classList.contains("expanded")) {
                    // Collapse the menu
                    tabNav.classList.remove("expanded");
                    toggleBtn.classList.add("collapsed");
                    toggleBtn.innerHTML = '<span>📂</span><span>Show Navigation Menu</span><span class="arrow">▼</span>';
                } else {
                    // Expand the menu
                    tabNav.classList.add("expanded");
                    toggleBtn.classList.remove("collapsed");
                    toggleBtn.innerHTML = '<span>📂</span><span>Hide Navigation Menu</span><span class="arrow">▼</span>';
                }
            }
        }

        function toggleSection(button) {
            if (!button || !button.nextElementSibling) return;
            
            var content = button.nextElementSibling;
            var isCollapsed = content.classList.contains("expanded");
            
            if (isCollapsed) {
                content.classList.remove("expanded");
                button.classList.add("collapsed");
            } else {
                content.classList.add("expanded");
                button.classList.remove("collapsed");
            }
        }

        function copyCode(elementId) {
            const codeContent = document.getElementById(elementId);
            if (!codeContent) return;
            
            let copyBtn;
            // Get the correct copy button based on the code element
            if (elementId === 'step1Code') copyBtn = document.getElementById('copyBtn1');
            else if (elementId === 'step2Code') copyBtn = document.getElementById('copyBtn2');
            else if (elementId === 'step3Code') copyBtn = document.getElementById('copyBtn3');
            else if (elementId === 'step4Code') copyBtn = document.getElementById('copyBtn4');
            else if (elementId === 'step5Code') copyBtn = document.getElementById('copyBtn5');
            else if (elementId === 'step6Code') copyBtn = document.getElementById('copyBtn6');
            
            if (!copyBtn) return;
            
            // Get the text content without HTML tags
            const textContent = codeContent.innerText || codeContent.textContent;
            
            // Copy to clipboard
            navigator.clipboard.writeText(textContent).then(function() {
                // Change button appearance
                copyBtn.innerHTML = '<span>✅</span> Copied!';
                copyBtn.classList.add('copied');
                
                // Reset button after 2 seconds
                setTimeout(function() {
                    copyBtn.innerHTML = '<span>📋</span> Copy Code';
                    copyBtn.classList.remove('copied');
                }, 2000);
            }).catch(function(err) {
                console.error('Could not copy text: ', err);
                // Fallback for older browsers
                const textarea = document.createElement('textarea');
                textarea.value = textContent;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                
                copyBtn.innerHTML = '<span>✅</span> Copied!';
                copyBtn.classList.add('copied');
                
                setTimeout(function() {
                    copyBtn.innerHTML = '<span>📋</span> Copy Code';
                    copyBtn.classList.remove('copied');
                }, 2000);
            });
        }

        function loadMarkdownFromPath() {
            const pathInput = document.getElementById('markdownPath');
            const filePath = pathInput.value.trim();
            
            if (!filePath) {
                alert('Please enter a file path or URL to the markdown file.');
                return;
            }
            
            // Check if file has .md or .markdown extension
            if (!filePath.toLowerCase().endsWith('.md') && !filePath.toLowerCase().endsWith('.markdown')) {
                alert('Please enter a valid .md or .markdown file path.');
                return;
            }
            
            loadMarkdownFile(filePath);
        }

        async function loadMarkdownFile(filePath) {
            const loadingDiv = document.getElementById('markdownLoading');
            const outputSection = document.getElementById('markdownOutputSection');
            const contentDiv = document.getElementById('markdownContent');
            const fileNameSpan = document.getElementById('markdownFileName');
            
            // Show loading indicator
            if (loadingDiv) loadingDiv.style.display = 'block';
            if (outputSection) outputSection.style.display = 'none';
            
            try {
                let markdownText = '';
                
                // Check if it's a web URL or local file
                if (filePath.startsWith('http://') || filePath.startsWith('https://')) {
                    // Load from web URL
                    const response = await fetch(filePath);
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    markdownText = await response.text();
                } else {
                    // Load from local file using the file system API
                    try {
                        markdownText = await window.fs.readFile(filePath, { encoding: 'utf8' });
                    } catch (fsError) {
                        // If file system API fails, try fetch for relative paths
                        const response = await fetch(filePath);
                        if (!response.ok) {
                            throw new Error(`Could not load file: ${filePath}. Make sure the file path is correct.`);
                        }
                        markdownText = await response.text();
                    }
                }
                
                // Parse and display the markdown content
                const htmlContent = parseMarkdown(markdownText);
                
                if (contentDiv) {
                    contentDiv.innerHTML = htmlContent;
                }
                
                if (fileNameSpan) {
                    const fileName = filePath.split('/').pop() || filePath;
                    fileNameSpan.textContent = ` - ${fileName}`;
                }
                
                if (outputSection) {
                    outputSection.style.display = 'block';
                }
                
            } catch (error) {
                console.error('Error loading markdown file:', error);
                
                if (contentDiv) {
                    contentDiv.innerHTML = `
                        <div style="color: #dc2626; padding: 20px; background: rgba(220, 38, 38, 0.1); border-radius: 8px; border-left: 4px solid #dc2626;">
                            <h3>❌ Error Loading Markdown File</h3>
                            <p><strong>Could not load:</strong> ${filePath}</p>
                            <p><strong>Error:</strong> ${error.message}</p>
                            <p><strong>Suggestions:</strong></p>
                            <ul>
                                <li>Verify the file path is correct and the file exists</li>
                                <li>Ensure the file has .md or .markdown extension</li>
                                <li>For web URLs, make sure the server allows cross-origin requests</li>
                                <li>For local files, use relative paths like ./docs/file.md</li>
                                <li>Check file permissions and accessibility</li>
                            </ul>
                        </div>
                    `;
                }
                
                if (fileNameSpan) {
                    fileNameSpan.textContent = ' - Error loading file';
                }
                
                if (outputSection) {
                    outputSection.style.display = 'block';
                }
            } finally {
                // Hide loading indicator
                if (loadingDiv) loadingDiv.style.display = 'none';
            }
        }

        function handleMarkdownUpload(event) {
            const file = event.target.files[0];
            if (file && (file.name.endsWith('.md') || file.name.endsWith('.markdown'))) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const markdownText = e.target.result;
                    const htmlContent = parseMarkdown(markdownText);
                    
                    // Display the content
                    const outputSection = document.getElementById('markdownOutputSection');
                    const contentDiv = document.getElementById('markdownContent');
                    
                    if (outputSection && contentDiv) {
                        contentDiv.innerHTML = htmlContent;
                        outputSection.style.display = 'block';
                    }
                };
                reader.readAsText(file);
            } else {
                alert('Please select a valid .md or .markdown file.');
            }
        }

        function parseMarkdown(markdown) {
            let html = markdown;
            
            // Headers
            html = html.replace(/^### (.*$)/gm, '<h3>$1</h3>');
            html = html.replace(/^## (.*$)/gm, '<h2>$1</h2>');
            html = html.replace(/^# (.*$)/gm, '<h1>$1</h1>');
            
            // Bold and Italic
            html = html.replace(/\*\*\*(.*?)\*\*\*/g, '<strong><em>$1</em></strong>');
            html = html.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            html = html.replace(/\*(.*?)\*/g, '<em>$1</em>');
            
            // Code blocks
            html = html.replace(/```([\s\S]*?)```/g, '<pre><code>$1</code></pre>');
            html = html.replace(/`(.*?)`/g, '<code>$1</code>');
            
            // Links
            html = html.replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2" target="_blank">$1</a>');
            
            // Images
            html = html.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, '<img src="$2" alt="$1">');
            
            // Blockquotes
            html = html.replace(/^> (.*$)/gm, '<blockquote>$1</blockquote>');
            
            // Horizontal rules
            html = html.replace(/^---$/gm, '<hr>');
            html = html.replace(/^\*\*\*$/gm, '<hr>');
            
            // Lists
            html = html.replace(/^\* (.*$)/gm, '<li>$1</li>');
            html = html.replace(/^\d+\. (.*$)/gm, '<li>$1</li>');
            
            // Wrap consecutive list items
            html = html.replace(/(<li>.*<\/li>)/gs, function(match) {
                return '<ul>' + match + '</ul>';
            });
            
            // Tables (basic support)
            html = html.replace(/\|(.+)\|/g, function(match, content) {
                const cells = content.split('|').map(cell => cell.trim());
                const isHeader = match.includes('---');
                if (isHeader) return '';
                
                const tag = cells[0] === '' ? 'td' : 'th';
                const cellsHtml = cells.filter(cell => cell !== '').map(cell => `<${tag}>${cell}</${tag}>`).join('');
                return `<tr>${cellsHtml}</tr>`;
            });
            
            // Wrap table rows
            html = html.replace(/(<tr>.*<\/tr>)/gs, function(match) {
                return '<table>' + match + '</table>';
            });
            
            // Paragraphs
            html = html.replace(/\n\n/g, '</p><p>');
            html = '<p>' + html + '</p>';
            
            // Clean up empty paragraphs
            html = html.replace(/<p><\/p>/g, '');
            html = html.replace(/<p>(<h[1-6]>)/g, '$1');
            html = html.replace(/(<\/h[1-6]>)<\/p>/g, '$1');
            html = html.replace(/<p>(<blockquote>)/g, '$1');
            html = html.replace(/(<\/blockquote>)<\/p>/g, '$1');
            html = html.replace(/<p>(<hr>)<\/p>/g, '$1');
            html = html.replace(/<p>(<ul>)/g, '$1');
            html = html.replace(/(<\/ul>)<\/p>/g, '$1');
            html = html.replace(/<p>(<table>)/g, '$1');
            html = html.replace(/(<\/table>)<\/p>/g, '$1');
            html = html.replace(/<p>(<pre>)/g, '$1');
            html = html.replace(/(<\/pre>)<\/p>/g, '$1');
            
            return html;
        }

        function displayImage(event) {
            const file = event.target.files[0];
            if (file && file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const placeholder = document.getElementById('imagePlaceholder');
                    const uploadedImage = document.getElementById('uploadedImage');
                    
                    if (placeholder && uploadedImage) {
                        // Hide placeholder and show image
                        placeholder.style.display = 'none';
                        uploadedImage.src = e.target.result;
                        uploadedImage.style.display = 'block';
                        
                        // Optional: Add click handler to uploaded image to change it
                        uploadedImage.onclick = function() {
                            const upload = document.getElementById('imageUpload');
                            if (upload) upload.click();
                        };
                    }
                };
                reader.readAsDataURL(file);
            }
        }

        function displayResultImage(event) {
            const file = event.target.files[0];
            if (file && file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const placeholder = document.getElementById('resultImagePlaceholder');
                    const uploadedImage = document.getElementById('uploadedResultImage');
                    
                    if (placeholder && uploadedImage) {
                        // Hide placeholder and show image
                        placeholder.style.display = 'none';
                        uploadedImage.src = e.target.result;
                        uploadedImage.style.display = 'block';
                        
                        // Optional: Add click handler to uploaded image to change it
                        uploadedImage.onclick = function() {
                            const upload = document.getElementById('resultImageUpload');
                            if (upload) upload.click();
                        };
                    }
                };
                reader.readAsDataURL(file);
            }
        }

        // Initialize the page with collapsed navigation by default
        document.addEventListener('DOMContentLoaded', function() {
            // Set navigation as collapsed by default
            var tabNav = document.getElementById("tabNavigation");
            var toggleBtn = document.getElementById("tabToggleBtn");
            
            if (tabNav && toggleBtn) {
                tabNav.classList.remove("expanded");
                toggleBtn.classList.add("collapsed");
            }
            
            // Initialize all content sections as collapsed by default
            var sections = document.querySelectorAll('.section-content');
            var buttons = document.querySelectorAll('.section-toggle');
            
            sections.forEach(function(section) {
                if (section) section.classList.remove('expanded');
            });
            
            buttons.forEach(function(button) {
                if (button) button.classList.add('collapsed');
            });
        });
    </script>
</body>
</html>
